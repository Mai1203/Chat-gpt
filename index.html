<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat GPT local</title>
    <style>
        body{
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background: #c1c1c1;
            display: grid;
            place-content: center;
            height: 100dvh; /*dynamic viewport height */    
        }
        main{
            width: 400px;
            max-width: 100%;
            height: 70vh;
            background: #f1f1f1;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow:  0 0 10px rgba(0,0,0, 0.1);
            padding: 8px;
            margin-bottom: 16px;
            overflow-y: auto;
            scroll-behavior: smooth;
        }
        ul {
            display: flex;
            flex-direction: column;
            list-style: none;
            padding: 0;
        }
        .message {
            display: flex;
            flex-direction: column;
            gap: 4px;
            margin: 4px 0;
            padding: 4px 8px;

            > span{
                width: 36px;
                height: 36px;
                background: #c9c9c9;
                font-size: 12px;
                font-weight: 500;
                display: flex;
                justify-content: center;
                align-items: center;
                border-radius: 999999px;
            }
            > p{
                border-radius: 4px;
                padding: 4px 8px;
                margin-top: 8px;
            }

            &.user{
                align-self: flex-end;
                align-items: flex-end;
                span,p{
                    background: #e2e5eb;
                }
            }

            &.bot {
                align-self: flex-start;
                span,p{
                    background: #e3e4e1;
                }
            }
        }
        form {
            display: flex;
            input{
                border-radius: 9px;
                flex-grow: 1;
                border: 0;
                padding: 8px;
                margin-right: 8px;
                border: 1px solid#ccc;
            }
        }
        button{
            background: #09f;
            border: 0;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            padding: 8px;
            transition: background .3s ease;
            
            &:hover{
                background: rgb(0, 104, 173);
            }

            &[disabled]{
                background: #ccc;
                opacity: .6;
            }
        }

    </style>
    <script type="module">
        const $ = el => document.querySelector(el)

        const $form = $('form')
        const $input = $('input')
        const $template = $('#message-template')
        const $messages = $('ul')
        const $container = $('main')
        const $button = $('button')

        $form.addEventListener('submit', (e) => {
            e.preventDefault()
            const messageText = $input.value.trim()

            if(messageText !== ''){
                $input.value= ''
            }

            addMessage(messageText, 'user')

            $button.setAttribute('disabled', true)
            
            setTimeout(()=> {
                addMessage('hola desde el bot', 'bot')
                $button.removeAttribute('disabled')
            }, 2000)
        })

        function addMessage(text, sender){
            const clonedTemplate = $template.content.cloneNode(true)
            const $newMessage = clonedTemplate.querySelector('.message')
            const $who = $newMessage.querySelector('span')
            const $text = $newMessage.querySelector('p')

            $text.textContent = text
            $who.textContent = sender === 'bot' ? 'GPT' : 'Tu'
            $newMessage.classList.add(sender)

            $messages.appendChild($newMessage)
            $container.scrollTop = $container.scrollHeight

        }
    </script>
</head>
<body>
    <main>
        <ul>
            <li class="message bot">
                <span>
                    GPT
                </span>
                <p>
                    Respuesta del bot
            </p>
            </li>
            <li class="message user">
                <span>
                    Tu
                </span>
                <p>
                    Respuesta del Usuario
            </p>
            </li>
            <li class="message user">
                <span>
                    Tu
                </span>
                <p>
                    Respuesta del Usuario Lorem ipsum dolor sit amet consectetur adipisicing elit. Animi, blanditiis eaque! Dicta, veritatis fugiat. Maiores odit ipsam exercitationem similique tempora quam ea, voluptas est iusto dicta unde asperiores cupiditate blanditiis?
            </p>
            </li>
        </ul>
    </main>
    <form>
        <input placeholder="Escribe tu pregunta">
        <button>Enviar</button>
    </form>

    <template id="message-template">
        <li class="message">
            <span></span>
            <p></p>
        </li>
    </template>
</body>
</html>